var UnoDropZone={settings:{uploadContSelector:".file-upload",defaultMessage:"Drop image in here or click to upload"},util:{executeFunctionByName:function(e,t){var n="";try{n=e.substring(0,e.indexOf(".")),n=window[n],e=e.substring(e.indexOf(".")+1,e.length);[].slice.call(arguments).splice(2);for(var o=e.split("."),a=o.pop(),i=0;i<o.length;i++)n=n[o[i]];return n[a].apply,n[a].apply(this,[t])}catch(t){console.log("Error while calling callback method["+e+"]"),console.log(t)}},bytesToSize:function(e){if(0===e)return"0 Byte";var t=parseInt(Math.floor(Math.log(e)/Math.log(1024)));return Math.round(e/Math.pow(1024,t),2)+" "+["Bytes","KB","MB","GB","TB"][t]}},init:function(e){$(UnoDropZone.settings.uploadContSelector).each(function(t,n){UnoDropZone.initSingleFileZone(n,e)})},initSingleFileZone:function(e,t){console.log("initSingleFileZone:"),console.log(e),$(e).html("");var n=document.createElement("div");n.classList.add("file-input");var o=document.createElement("input"),a=e.getAttribute("data-input-name");o.setAttribute("name",a),o.setAttribute("type","file"),o.setAttribute("accept","image/*");var i=e.getAttribute("data-callback");i&&o.setAttribute("data-callback",i),o.addEventListener("change",UnoDropZone.handleInputFiles,!1),n.appendChild(o),e.appendChild(n);var r=document.createElement("div");r.classList.add("drop-click-zone");var l=document.createElement("div");l.classList.add("filethumbnail"),r.appendChild(l),r.addEventListener("dragenter",UnoDropZone.dropZone.dragenter,!1),r.addEventListener("dragover",UnoDropZone.dropZone.dragover,!1),r.addEventListener("drop",UnoDropZone.dropZone.drop,!1),r.addEventListener("click",UnoDropZone.dropZone.click,!1),e.appendChild(r);var s=document.createElement("div");s.classList.add("info"),e.appendChild(s);var d=document.createElement("div");d.classList.add("message");var c=UnoDropZone.settings.defaultMessage;t&&(c=t),e.getAttribute("data-unodz-msg")&&(c=e.getAttribute("data-unodz-msg")),d.innerHTML=c,d.addEventListener("click",UnoDropZone.dropZone.click,!1),e.appendChild(d)},handleInputFiles:function(){UnoDropZone.handleFiles(this.files,this)},handleFiles:function(e,t){var n=UnoDropZone.settings.uploadContSelector;console.log("handleInputFiles ...");var o=e[0];if(o){console.log(o.name),console.log(o.size),console.log(UnoDropZone.util.bytesToSize(o.size));if(!/^image\//.test(o.type))return console.log("is not an image. we will not proccess "),void $(this).val("");var a=document.createElement("span");a.classList.add("name"),a.innerHTML=o.name;var i=document.createElement("span");i.classList.add("size"),i.innerHTML=UnoDropZone.util.bytesToSize(o.size);var r="Name: "+o.name+" Size:"+UnoDropZone.util.bytesToSize(o.size),l=$(t).parents(n),s=$(l).find(".info");$(l).attr("title",r),$(s).html(""),$(s).append(a),$(s).append(i);var d=document.createElement("img");d.classList.add("img");var c=$(l).find(".drop-click-zone .filethumbnail");$(c).html(""),$(c).append(d);var p=new FileReader;p.onload=function(e){return function(t){e.src=t.target.result}}(d),p.readAsDataURL(o),$(l).attr("data-unodz-callback")&&UnoDropZone.util.executeFunctionByName($(l).attr("data-unodz-callback"),$(l))}},dropZone:{dragenter:function(e){e.stopPropagation(),e.preventDefault(),console.log("dragenter")},dragover:function(e){e.stopPropagation(),e.preventDefault(),console.log("dragover")},drop:function(e){e.stopPropagation(),e.preventDefault();var t=e.dataTransfer.files,n=$(this).siblings(".file-input").first().children("input").first();n.files=t,UnoDropZone.handleFiles(t,n)},click:function(e){e.stopPropagation(),e.preventDefault(),$(this).siblings(".file-input").first().children("input").first().click()}}};